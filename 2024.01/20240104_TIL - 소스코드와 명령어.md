# 20240104_TIL - 소스코드와 명령어

## 컴퓨터가 소스코드를 읽는 방법

### 고급 언어와 저급 언어

`고급언어(high-level language)`는 개발자가 이해하기 쉽게 만든 언어다. Java, C, Python 등이 이에 해당한다. 컴퓨터는 이대로 먹으라고 주면 못 받아먹는다.

`저급언어(low-level language)`는 컴퓨터가 이해하는 언어다. 이진법 혹은 십육진법으로 표현된 명령어들인 기계어와 이를 그나마 사람말로 번역한 어셈블리로 나뉜다. 사람에게 친화적이지 못하다.

그렇게 때문에, 개발자가 고급 언어로 작성한 소스 코드를 컴퓨터가 알아듣기 위해서는 이를 변환시켜주는 과정이 필요하다. 

### 컴파일 방식과 인터프리트 방식

소스코드를 로우 레벨의 목적코드로 변환하는 데는 두 가지 방식이 있다. 한 번에 통으로 번역하는 `컴파일 방식`과 한 줄씩 읽어서 명령어 단위로 전환하는 `인터프리트 방식`이다.

`컴파일 방식`은 컴파일러를 통해 소스코드를 통째로 변환시킨다. 변환 과정에서 하나라도 오류가 발생하면 이전까지 오류가 없었던 코드도 실행되지 않는다. `C`가 이 컴파일 방식에 해당한다. 

`인터프리트 방식`은 인터프리터를 통해 소스코드가 한 줄씩 실행된다. 변환 과정에서 오류가 발생하기 전까지는 정상 작동한다. 기본적으로 컴파일 방식보다 속도가 느리다. 대표적인 언어로 `Python`이 있다. 

어떤 프로그래밍 언어가 컴파일 언어나 인터프리트 언어로 딱 잘라 나뉘기는 어렵다. `Java`의 경우 기본적으로 인터프리팅 방식으로 변환을 진행하지만 `JLT 컴파일러`를 통해 효율적인 방식으로 코드를 읽어오는 과정을 거친다.

## 명령어의 구조

위에서 배운 내용을 정리해보자. 저급언어는 어셈블리나 기계어로 표현된 명령어이고, CPU는 이를 명령어 단위로 읽어와서 실행한다. 그럼 컴퓨터는 이 명령어를 어떻게 알아 듣는 것일까?

### 연산 코드와 오퍼랜드

가장 쉬운 예시를 생각해보자. 컴퓨터에게 1+2를 계산해달라고 해보았다.

```java
int plus(int a, int b) {
      return a + b;
}

public static void main(String[] args) {
      int result = plus(1, 2);
      System.out.println(result); // output : 3
}
```

이를 컴퓨터는 다음과 같은 방식으로 읽는다.

```java
--------------------------------------------
| 더해라 |       1       |         2        |
--------------------------------------------
```

여기서 `더하라`는 필드에 해당하는 것이 `연산 코드(operation code)`, 연산자에 해당하고, 더하는 주체가 되는 1, 2가 써있는 곳에 해당하는 것이 `오퍼랜드(operand)`, 피연산자가 된다.

`연산 코드`는 수행할 연산을 나타내고, `오퍼랜드`는 연산에 사용될 데이터 또는 그 데이터가 저장된 위치(레지스터 이름 또는 메모리 주소)를 담고 있다. 그래서 `오퍼랜드`를 `주소필드`라고 부르기도 한다.

명령어에 따라 연산에 필요한 연산자가 혹은 주소가 없는 경우도 있다. 즉 명령어에서 `오퍼랜드`는 반드시 있어야 하는 것은 아니다.

### 연산 코드의 종류

연산 코드의 종류는 CPU의 종류에 따라 그 모양이나 종류가 다양하다.

- `데이터 전송`: 말 그대로 데이터를 다루는 명령어다.
    - `MOVE` 데이터 이동
    - `STORE` 메모리에 데이터 저장
    - `LOAD(FETCH)` 메모리에서 CPU로 데이터 가져오기
    - `PUSH` 스택에 데이터 저장
    - `POP` 실행하기 위해 스택의 최상단 데이터 가져오기
        
        이 ‘스택’이 정확히 뭘 의미하는 지는 잘 모르겠지만, 명령어와 관련되어 있으니 콜 스택이라고 이해하고 넘어가겠다. 추후 더 알아보면 좋을 것 같다.
        
- `산술/논리 연산`: 사칙연산, 논리연산, 비교연산
- `제어 흐름 변경`
    - `(CONDITIONAL) JUMP`: (조건에 부합할 때) 특정 주소로 실행 순서 옮기기
    - `HALT`: 프로그램의 실행을 멈추기
    - `CALL`: 되돌아올 주소를 저장한 채 특정 주소로 `JUMP`
    - `RETURN`: `CALL`과 세트, 저장했던 주소로 돌아가기
- `입출력 제어`: 데이터 읽고 쓰기, 입출력 장치 확인하기