# 20240314_TIL - 네트워크 계층 (1)

## 네트워크 계층

- 전송자 측에서는 세그먼트를 데이터그램 안에 압축해서 집어넣는다.
- 수신자 측에서는 전달받은 세그먼트를 전송 계층으로 올려보낸다.
- 네트워크 계층의 프로토콜은 모든 호스트와 라우터 안에 들어있다.
- 라우터는 자기의 입력 링크에 도착한 모든 데이터그램의 헤더 필드를 해석해서 출력 링크로 전달한다.

### 네트워크 계층의 핵심 역할

- `포워딩(forwarding)`
    
    라우터의 입력 링크로 들어온 패킷을 알맞은 출력 링크로 이동시킨다.
    
- `라우팅(routing)`
    
    라우터에 패킷이 들어오면 어디로 가야 할 지 경로를 정해준다.
    

라우팅은 한 여행의 출발→도착 간 경로를 결정하는 과정이라면, 포워딩은 그 중 한 교차로를 지나는 것과 같다.

### 라우팅과 포워딩 사이 상호작용

라우터는 패킷이 들어오면 그 패킷을 목적지까지 전달하는 역할을 한다. 이 목적지로 가는 길을 정하는 방식을 `라우팅 알고리즘`이라고 한다.

- 라우터 안에는 `포워딩 테이블`이 존재한다. 포워딩 테이블은 라우팅 알고리즘에 의해 만들어진다. 생성된 테이블은 각 라우터의 입력 링크에 저장된다.
- `포워딩 테이블`에는 어떤 목적지로 가려면 어떤 출력 링크로 나가야 하는 지가 적혀 있다. 라우터는 이를 바탕으로 경로를 설정한다.
- `라우팅`은 포워딩 테이블을 참조해서 경로를 결정한다.
- `포워딩`은 패킷 헤더의 목적지 주소와 포워딩 테이블의 엔트리를 매칭시켜서 해당 링크로 내보낸다.
- 입력 링크에 들어오는 패킷은 포워딩 테이블과 매칭된다. 만약 패킷이 들어오는 속도가 매칭되는 것보다 빠르면 패킷이 잠시 큐에 임시 저장된다(여기서 패킷 지연 혹은 유실 발생).
- 포워딩 테이블은 라우터의 개수에 따라 기하급수적으로 커질 수 있다. 따라서 주소의 범위에 따라 출력 링크가 정해져 있다.