# 20240408_TIL - 데이터베이스 구축

## 데이터 모델링

### 스키마

데이터베이스 구조와 제약조건에 관한 전반적인 명세를 기술한 것을 말한다.

### DB 설계 순서

1. 요구조건 분석
2. 개념 모델링 → 개념 스키마 모델링, 트랜잭션 모델링, ERD 작성
3. 논리 모델링 → 목표 DBMS에 맞는 논리 스키마 설계, 트랜잭션 인터페이스 설계
4. 물리 모델링 → 물리적 구조의 데이터로 변환
5. 구현 → 목표 DBMS의 DDL로 데이터베이스 생성

### 개념적 설계

현질 세계에 대한 인식을 추상적 개념(Entity)으로 표현하는 과정

산출물인 ERD는 DBMS에 독립적이게 만든다.

### 논리적 설계

특정 DBMS가 지원하는 논리적인 자료 구조(릴레이션, like 테이블)로 매핑한다.

개념적 설계를 마친 개념 세계의 데이터(ERD의 엔티티)를 논리적인 구조의 데이터로 모델화한다.

### 물리적 설계

논리적 구조로 표현된 데이터를 물리적 구조의 데이터로 변환한다. 

데이터의 저장 구조나 엑세스 경로 등을 결정한다.

### 데이터 모델

현실 세계의 정보를 컴퓨터에 표현하기 위해 단순화하고 추상화해서 체계적으로 표현한 정보다.

객체지향 언어의 클래스를 생각하면 되겠다.

- `구조`
    
    논리적으로 표현된 개체 타입들 간의 관계. 데이터 구조 및 정적 성질을 표현한다.
    
- `연산`
    
    DB에 저장된 실제 데이터를 처리하는 작업에 대한 명세.
    
    DB를 조작하는 기본 도구가 된다.
    
- `제약조건`
    
    DB에 저장될 수 있는 실제 데이터의 논리적인 조건이다.
    

### ERD

- `개체(Entity)`: 사각형
- `관계`: 마름모
- `타원`: 속성
    - `이중 타원`: 다중값을 갖는 속성
    - `밑줄 타원`: 기본키
    - `복수 타원`: 복합 속성(ex: 이름은 성과 이름으로 나뉨)
- `관계`: 선 위에 1, N, M 등으로 표현

<br>

## 릴레이션

### 관계형 DB의 릴레이션 구조

- `속성`
    
    DB를 구성하는 가장 작은 논리적 단위. 개체의 특성을 기술한다. 
    
    속성의 수를 Degree 혹은 차수라고 한다.
    
- `튜플`
    
    속성의 모임이다. 파일에서는 레코드와 같은 의미를 가진다.
    
    튜플의 수를 카디널리티(Cardinality) 혹은 기수, 대응수라고 한다.
    
- `도메인`
    
    하나의 속성이 가질 수 있는 원자 값의 집합. 속성값의 유효성을 검사하는 데도 사용된다.
    

### Key

- `후보키`
    
    릴레이션을 구성하는 속성 중 튜플을 식별하게 하는 속성의 부분집합이다(복수일 수 있음).
    
    튜플을 식별하기 위해서 유일(Unique)해야 하고 최소성(Minimality)을 가져야 한다.
    
    기본키로 사용될 수 있는 후보라고 해서 후보키라고 한다.
    
- `기본키`
    
    후보키 중 선정된 메인 키. 중복된 값을 가질 수 없다.
    
- `대체키`
    
    후보키가 둘 이상일 때 기본키를 제외한 나머지 후보키를 말한다.
    
- `슈퍼키`
    
    릴레이션 내에 있는 속성들의 집합(복수)으로, 모든 튜플에 대해 유일성을 만족한다(최소성은 안됨).
    
- `외래키`
    
    다른 릴레이션의 기본키를 참조하는 속성 또는 속성들의 집합. 
    
    외래키로 지정되면 참조 릴레이션의 기본키에 없는 값은 입력할 수 없다.
    

### 시스템 카탈로그

시스템 DB로, 모든 데이터 객체의 정의나 명세 등 시스템 자체에 관련있는 정보인 `메타 데이터`를 담고 있다. 

카탈로그들은 생성되면 `데이터 사전`에 저장된다. 좁은 의미로는 카탈로그 자체를 데이터 사전이라고 하기도 한다.

### 트랜잭션

DB의 상태를 변환시키기 위해 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미한다. 

사용자의 request에 대한 시스템의 response를 준비하는 작업 단위로 사용된다.

- `원자성`
    
    트랜잭션 결과는 모두 반영되거나 아예 반영되지 않아야 한다.
    
- `일관성`
    
    트랜잭션이 완료되기 전과 후 모두 일관된 DB 상태를 유지해야 한다. 즉 트랜잭션 결과가 DB의 오작동을 불러일으켜선 안된다.
    
- `독립성`
    
    트랜잭션이 동시에 병행 실행되어도 서로의 결과에 영향을 줄 수 없다.
    
- `영속성`
    
    한 번 반영된 트랜잭션 결과는 시스템이 고장나도 영구적 반영되어야 한다.
    

### CRUD 분석

프로세스와 테이블 간에 생성, 읽기, 수정, 삭제 매트릭스를 통해 트랜잭션이 잘 일어나는지 확인한다.

### Index

데이터에 빠르게 접근하기 위해 `<키 값, 주소>` 쌍으로 구성된 데이터 구조를 말한다. 

레코드가 저장된 물리적 구조에 접근하는 방법을 제공한다.

<br>

## 관계대수와 관계해석

### 관계 대수

원하는 정보와 그 정보를 검색하기 위해 어떻게 유도하는가를 기술한다.  `절차적인 언어`다. 연산에 사용되는 피연산자와 결과가 모두 릴레이션이다.

ex) RDBMS에서 Select 문을 진행한 결과

### 순수 관계 연산자

- `SELECT`
    
    릴레이션에 존재하는 튜플 중 선택 조건을 만족하는 튜플들의 부분집합을 새로운 릴레이션으로 반환한다.
    
    조건에 맞는 ‘튜플’을 구하는 것이므로 수평 연산이라고도 한다. 
    
    기호는 `시그마`
    
- `PROJECT`
    
    주어진 릴레이션에서 선택한 속성의 값만 추출해 새로운 릴레이션으로 반환한다.
    
    조건에 맞는 ‘속성’을 추출하니까 수직 연산자라고도 한다.
    
    기호는 `파이`
    
- `JOIN`
    
    공통 속성을 중심으로 두 개의 릴레이션을 하나로 합쳐 새로운 릴레이션을 반환한다.
    
    결과는 교차곱을 진행한 릴레이션에 대해 Select를 진행한 것과 같다.
    
    기호는 `나비넥타이`
    
- `DIVISION`
    
    두 개의 릴레이션이 있을 때, 포함되는 쪽의 속성값을 제외한 속성만을 구하는 연산이다.
    
    기호는 `나누기`
    

### 일반 집합 연산자

- `UNION`: 합집합
- `INTERSECTION`: 교집합
- `DIFFERENCE`: 차집합
- `CARTESIAN PRODUCT`: 교차곱, 두 릴레이션의 튜플의 순서쌍.

### 관계해석

관계 데이터의 연산을 표현하는 방법이다. 코드씨가 관계형 DB를 위해 제안했다. 

원하는 정보가 무엇인지만 정의하는 `비절차적 특성`을 지닌다.

<br>

## 정규화

테이블의 속성들이 상호 종속적인 관계를 갖는 특성을 이용해 테이블을 데이터 손실 없이 분해한다.

가능한 중복을 피해 이상의 발생 가능성을 줄이는 목적이다.

### 이상

릴레이션 조작 시 예기치 않게 발생하는 곤란한 현상. DB 내 데이터의 불필요한 중복이 원인이 된다.

- `삽입 이상`
    
    데이터를 삽입할 때 원하지 않는 값이 있어(기본값에 null 등) 삽입이 안됨
    
- `삭제 이상`
    
    테이블에서 특정 튜플을 삭제할 떄 상관 없는 값들이 같이 삭제됨
    
- `갱신 이상`
    
    특정 튜플의 속성값을 갱신할 때 일부만 갱신되어 데이터의 불일치가 발생함
    

### 함수적 종속

f(x) → y같이, 한 속성의 값에 대해 다른 한 속성에서 연관된 값이 오직 하나만 존재한다. 

- `완전(Full) 함수적 종속`
    
    한 속성이 다른 속성 집합 전체에 대해 함수적 종속이면서, 그 부분집합 중에 함수적 종속관계인 경우가 없다.
    
- `부분(Partial) 함수적 종속`
    
    완전 함수적 종속의 반대되는 경우
    
- `이행적(Transitive) 함수적 종속`
    
    X → Y, Z / Y → Z인 관계
    

### 정규화 과정

1. `제 1 정규형` 
    
    도메인의 모든 속성값이 원자값(여러 값을 갖지 않음)
    
2. `제 2 정규형`
    
    부분적 함수 종속 제거
    
3. `제 3 정규형`
    
    이행적 함수 종속 제거
    
4. `BCNF`
    
    결정자들이 모두 후보키여야 함. 아닌 애들 제거
    
5. `제 4 정규형`
    
    다치 종속 제거
    
6. `제 5 정규형`
    
    Join 종속성 이용(모든 프로젝션의 Join == 전체 릴레이션인 경우)
    

### 반정규화

시스템의 성능 향상과 개발 및 운영 편의성을 위해 데이터를 의도적으로 정규화를 위배하여 저장하는 방법. 

데이터의 일관성과 정합성은 저하될 수 있다. 또한 과도하게 반정규화하면 역으로 성능 저하가 발생할 수도 있다.